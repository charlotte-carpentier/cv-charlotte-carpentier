{# 
=======================
        FOOTER        
=======================
#}

{% from "03-atoms/link.njk" import renderLink %}
{% from "03-atoms/heading.njk" import renderHeading %}
{% from "03-atoms/icon.njk" import renderIcon %}
{% from "03-atoms/vector.njk" import renderVector %}

{% macro renderFooter(options) %}
  {% if options.datas %}
    {% set globalStyle = options.datas.globalStyle %}
    {% set variants = options.datas.variants %}
    
    {# Récupération du footer spécifique #}
    {% set footerData = null %}
    {% if options.name %}
      {% for footerSet in options.datas.footers %}
        {% if footerSet.name == options.name %}
          {% set footerData = footerSet %}
        {% endif %}
      {% endfor %}
    {% endif %}

    {% if not footerData %}
      {% set footerData = options.datas.footers[0] %}
    {% endif %}
    
    {# Debug: Afficher les données disponibles #}
    {# <pre class="text-white text-xs">{{ options | json }}</pre> #}
    
    <footer class="{{ globalStyle }} {{ footerData.containerStyle }} {{ options.class | default('') }}">
      <div class="container mx-auto px-4 py-6">
        {# Structure modifiée: 2 colonnes, logo, puis 1 colonne #}
        <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
          {# Colonnes 1-2 #}
          {% if footerData.columns %}
            {% for menuConfig in footerData.columns %}
              {% if loop.index <= 2 %}
                <div class="footer-column text-center md:text-left">
                  {# Titres des sections #}
                  {% if menuConfig.name == "contact_navigation" %}
                    <h4 class="text-[theme(--ma-nautic-white)] font-bold mb-4 font-['Vibur']">CONTACT</h4>
                  {% elif menuConfig.name == "site_navigation" %}
                    <h4 class="text-[theme(--ma-nautic-white)] font-bold mb-4 font-['Vibur']">NAVIGATION</h4>
                  {% elif menuConfig.name == "socials" %}
                    <h4 class="text-[theme(--ma-nautic-white)] font-bold mb-4 font-['Vibur']">SUIVEZ-NOUS</h4>
                  {% endif %}
                  
                  {# Navigation secondaire basée directement sur les données #}
                  <nav class="space-y-3">
                    {% if options["navigation-secondarys"] and options["navigation-secondarys"]["navigation-secondarys"] %}
                      {% for navGroup in options["navigation-secondarys"]["navigation-secondarys"] %}
                        {% if navGroup.name == menuConfig.name and navGroup.links %}
                          {% for linkName in navGroup.links %}
                            {% if options.links and options.links.links %}
                              {% for link in options.links.links %}
                                {% if link.name == linkName %}
                                  {# Contact Navigation avec icônes #}
                                  {% if menuConfig.name == "contact_navigation" %}
                                    <div class="flex items-center mb-3 justify-center md:justify-start">
                                      {# Détermination de l'icône à utiliser #}
                                      {% set iconName = "" %}
                                      {% if link.name == "adresse" %}{% set iconName = "dot" %}
                                      {% elif link.name == "telephone" %}{% set iconName = "phone" %}
                                      {% elif link.name == "formulaire" %}{% set iconName = "mail" %}
                                      {% elif link.name == "horaires" %}{% set iconName = "clock" %}
                                      {% else %}{% set iconName = "dot" %}{% endif %}
                                      
                                      {# Recherche de l'icône #}
                                      {% if options.icons and options.icons.icons %}
                                        {% for icon in options.icons.icons %}
                                          {% if icon.name == iconName %}
                                            <span 
                                              data-svg-src="{{ icon.path }}" 
                                              class="icon w-4 h-4 text-[theme(--ma-nautic-teal)] mr-2"
                                              aria-hidden="true"
                                            ></span>
                                          {% endif %}
                                        {% endfor %}
                                      {% endif %}
                                      
                                      <a href="{{ link.href }}" class="text-[theme(--ma-nautic-white)] hover:text-[theme(--ma-nautic-teal)]">
                                        {{ link.text | safe }}
                                      </a>
                                    </div>
                                  
                                  {# Réseaux sociaux avec icônes #}
                                  {% elif menuConfig.name == "socials" %}
                                    <div class="flex items-center mb-3 justify-center md:justify-start">
                                      {# Recherche de l'icône sociale #}
                                      {% if options.icons and options.icons.icons %}
                                        {% for icon in options.icons.icons %}
                                          {% if icon.name == link.name %}
                                            <span 
                                              data-svg-src="{{ icon.path }}" 
                                              class="icon w-4 h-4 text-[theme(--ma-nautic-teal)] mr-2"
                                              aria-hidden="true"
                                            ></span>
                                          {% endif %}
                                        {% endfor %}
                                      {% endif %}
                                      
                                      <a href="{{ link.href }}" class="text-[theme(--ma-nautic-white)] hover:text-[theme(--ma-nautic-teal)]">
                                        {{ link.text }}
                                      </a>
                                    </div>
                                  
                                  {# Liens de navigation standards #}
                                  {% else %}
                                    <div class="mb-3 text-center md:text-left">
                                      <a href="{{ link.href }}" class="text-[theme(--ma-nautic-white)] hover:text-[theme(--ma-nautic-teal)] transition-all duration-300">
                                        {{ link.text }}
                                      </a>
                                    </div>
                                  {% endif %}
                                {% endif %}
                              {% endfor %}
                            {% endif %}
                          {% endfor %}
                        {% endif %}
                      {% endfor %}
                    {% else %}
                      <div class="text-[theme(--ma-nautic-teal)] text-sm">Navigation non configurée</div>
                    {% endif %}
                  </nav>
                </div>
              {% endif %}
            {% endfor %}
          {% endif %}
          
          {# Logo maintenant au milieu (3ème position) #}
          <div class="flex justify-center md:justify-start items-center">
            {% if footerData.vectors and options.vectors %}
              {% set vectorData = null %}
              {% for vector in options.vectors.vectors %}
                {% if vector.name == footerData.vectors %}
                  {% set vectorData = vector %}
                {% endif %}
              {% endfor %}

              {% if vectorData %}
                <img src="{{ vectorData.src }}" alt="{{ vectorData.alt }}" class="{{ options.vectors.globalStyle }} {{ options.vectors.sizes[vectorData.size] }} md:max-w-[150px]">
              {% endif %}
            {% endif %}
          </div>
          
          {# Dernière colonne (4ème position) #}
          {% if footerData.columns %}
            {% for menuConfig in footerData.columns %}
              {% if loop.index == 3 %}
                <div class="footer-column text-center md:text-left">
                  {# Titres des sections #}
                  {% if menuConfig.name == "contact_navigation" %}
                    <h4 class="text-[theme(--ma-nautic-white)] font-bold mb-4 font-['Vibur']">CONTACT</h4>
                  {% elif menuConfig.name == "site_navigation" %}
                    <h4 class="text-[theme(--ma-nautic-white)] font-bold mb-4 font-['Vibur']">NAVIGATION</h4>
                  {% elif menuConfig.name == "socials" %}
                    <h4 class="text-[theme(--ma-nautic-white)] font-bold mb-4 font-['Vibur']">SUIVEZ-NOUS</h4>
                  {% endif %}
                  
                  {# Navigation secondaire basée directement sur les données #}
                  <nav class="space-y-3">
                    {% if options["navigation-secondarys"] and options["navigation-secondarys"]["navigation-secondarys"] %}
                      {% for navGroup in options["navigation-secondarys"]["navigation-secondarys"] %}
                        {% if navGroup.name == menuConfig.name and navGroup.links %}
                          {% for linkName in navGroup.links %}
                            {% if options.links and options.links.links %}
                              {% for link in options.links.links %}
                                {% if link.name == linkName %}
                                  {# Contact Navigation avec icônes #}
                                  {% if menuConfig.name == "contact_navigation" %}
                                    <div class="flex items-center mb-3 justify-center md:justify-start">
                                      {# Détermination de l'icône à utiliser #}
                                      {% set iconName = "" %}
                                      {% if link.name == "adresse" %}{% set iconName = "dot" %}
                                      {% elif link.name == "telephone" %}{% set iconName = "phone" %}
                                      {% elif link.name == "formulaire" %}{% set iconName = "mail" %}
                                      {% elif link.name == "horaires" %}{% set iconName = "clock" %}
                                      {% else %}{% set iconName = "dot" %}{% endif %}
                                      
                                      {# Recherche de l'icône #}
                                      {% if options.icons and options.icons.icons %}
                                        {% for icon in options.icons.icons %}
                                          {% if icon.name == iconName %}
                                            <span 
                                              data-svg-src="{{ icon.path }}" 
                                              class="icon w-4 h-4 text-[theme(--ma-nautic-teal)] mr-2"
                                              aria-hidden="true"
                                            ></span>
                                          {% endif %}
                                        {% endfor %}
                                      {% endif %}
                                      
                                      <a href="{{ link.href }}" class="text-[theme(--ma-nautic-white)] hover:text-[theme(--ma-nautic-teal)]">
                                        {{ link.text | safe }}
                                      </a>
                                    </div>
                                  
                                  {# Réseaux sociaux avec icônes #}
                                  {% elif menuConfig.name == "socials" %}
                                    <div class="flex items-center mb-3 justify-center md:justify-start">
                                      {# Recherche de l'icône sociale #}
                                      {% if options.icons and options.icons.icons %}
                                        {% for icon in options.icons.icons %}
                                          {% if icon.name == link.name %}
                                            <span 
                                              data-svg-src="{{ icon.path }}" 
                                              class="icon w-4 h-4 text-[theme(--ma-nautic-teal)] mr-2"
                                              aria-hidden="true"
                                            ></span>
                                          {% endif %}
                                        {% endfor %}
                                      {% endif %}
                                      
                                      <a href="{{ link.href }}" class="text-[theme(--ma-nautic-white)] hover:text-[theme(--ma-nautic-teal)]">
                                        {{ link.text }}
                                      </a>
                                    </div>
                                  
                                  {# Liens de navigation standards #}
                                  {% else %}
                                    <div class="mb-3 text-center md:text-left">
                                      <a href="{{ link.href }}" class="text-[theme(--ma-nautic-white)] hover:text-[theme(--ma-nautic-teal)] transition-all duration-300">
                                        {{ link.text }}
                                      </a>
                                    </div>
                                  {% endif %}
                                {% endif %}
                              {% endfor %}
                            {% endif %}
                          {% endfor %}
                        {% endif %}
                      {% endfor %}
                    {% else %}
                      <div class="text-[theme(--ma-nautic-teal)] text-sm">Navigation non configurée</div>
                    {% endif %}
                  </nav>
                </div>
              {% endif %}
            {% endfor %}
          {% endif %}
        </div>
        
        {# 5. Bottom section with copyright and links (in line) #}
        <div class="mt-12 border-t border-[theme(--ma-nautic-gold)] pt-4">
          <div class="flex flex-col md:flex-row md:items-center md:justify-between text-sm">
            {# Copyright et liens légaux #}
            <div class="text-[theme(--ma-nautic-white)] mb-4 md:mb-0 flex flex-wrap items-center justify-center md:justify-start gap-1">
              <span>© {% year %} {{ footerData.copyright | default('M.A Nautic tous droits réservés') }}</span>
              
              {# Version avec séparateur #}
              {% if footerData.version %}
                <span class="mx-2" aria-hidden="true">•</span>
                <span>v{{ footerData.version }}</span>
              {% endif %}
              
              {# Lien Crédits et mentions légales #}
              {% if footerData.links and footerData.links[0] and footerData.links[0].name == "credit" %}
                {% for link in options.links.links %}
                  {% if link.name == "credits" %}
                    <span class="mx-2" aria-hidden="true">•</span>
                    <a href="{{ link.href }}" class="text-[theme(--ma-nautic-white)] hover:text-[theme(--ma-nautic-teal)] transition-all duration-300">
                      {{ link.text }}
                    </a>
                  {% endif %}
                {% endfor %}
              {% endif %}
            </div>
            
            {# Autres liens du bas #}
            <div class="flex flex-col md:flex-row md:items-center space-y-2 md:space-y-0 items-center md:items-start">
              {% for linkConfig in footerData.links %}
                {% if linkConfig.name == "creator" %}
                  {% if options.links and options.links.links %}
                    {% for link in options.links.links %}
                      {% if link.name == linkConfig.name %}
                        <a href="{{ link.href }}" class="text-[theme(--ma-nautic-white)] hover:text-[theme(--ma-nautic-teal)] transition-all duration-300">
                          {{ link.text }}
                        </a>
                      {% endif %}
                    {% endfor %}
                  {% endif %}
                {% endif %}
              {% endfor %}
            </div>
          </div>
        </div>
      </div>
    </footer>
  {% else %}
    <span class="text-red-500">Footer data not found</span>
  {% endif %}
{% endmacro %}


{#
============================
Summon HAT Components Wisely
============================

1. Import the macro at the top of your page
{% from "01-organisms/footer.njk" import renderFooter %}

2. Call the footer component with a specific name
{{ renderFooter({ 
    name: "ma_nautic_footer",
    datas: organisms.footers,
    menus: organisms.menus,
    links: atoms.links,
    headings: atoms.headings,
    icons: atoms.icons,
    vectors: atoms.vectors,
    "navigation-secondarys": organisms["navigation-secondarys"]
}) }}

3. Usage with custom styles
{{ renderFooter({ 
    name: "ma_nautic_footer", 
    datas: organisms.footers,
    menus: organisms.menus,
    links: atoms.links,
    headings: atoms.headings,
    icons: atoms.icons,
    vectors: atoms.vectors,
    "navigation-secondarys": organisms["navigation-secondarys"],
    class: "my-custom-footer-class"
}) }}

Treasures often lie at the bottom 💰🔍
#}