{#
=========================
      SECTION HERO        
=========================
#}

{% macro renderSectionHero(options) %}
  {% if options.datas %}
    {# Sélection de variante sans utiliser selectattr #}
    {% set variant = null %}
    {% for hero in options.datas.heroes %}
      {% if hero.name == options.name %}
        {% set variant = hero %}
      {% endif %}
    {% endfor %}
    
    {# Si aucune variante n'est trouvée, utiliser la première par défaut #}
    {% if variant == null %}
      {% set variant = options.datas.heroes[0] %}
    {% endif %}

    {% set globalStyle = options.datas.globalStyle %}
    {% set variantStyle = options.datas.variants[variant.variant] | default(options.datas.variants.default) %}
    {% set containerStyle = options.datas.containerStyle %}
    {% set contentLayoutStyle = options.datas.contentLayoutStyle %}
    {% set textContainerStyle = options.datas.textContainerStyle %}
    {% set buttonsContainerStyle = options.datas.buttonsContainerStyle ~ " flex-row justify-center md:justify-start" %}
    {% set imageContainerStyle = options.datas.imageContainerStyle ~ " flex justify-center md:justify-start" %}

    {# Spécifique à MA-Nautic hero #}
    {% if variant.name == "ma_nautic_hero" %}
      <section class="{{ globalStyle }} {{ variantStyle }} relative h-[75vh] overflow-hidden {{ options.class | default('') }}">
        {# Background image #}
        {% if variant.backgroundImage %}
          {% set bgImage = null %}
          {% for image in options.images.images %}
            {% if image.name == variant.backgroundImage %}
              {% set bgImage = image %}
            {% endif %}
          {% endfor %}

          {% if bgImage %}
            <div class="absolute inset-0 z-0 ma-nautic-bg-fixed" style="background-image: url('{{ bgImage.src }}');">
              <div class="absolute inset-0 bg-ma-nautic-blue/30"></div>
            </div>
          {% endif %}
        {% endif %}

        {# Content container #}
        <div class="{{ containerStyle }} relative z-10 h-full flex items-center justify-center">
          <div class="flex flex-col items-center justify-center">
            {# Logo image à la place des headings #}
            {% if variant.image %}
              {% set logoImg = null %}
              {% for image in options.images.images %}
                {% if image.name == variant.image %}
                  {% set logoImg = image %}
                {% endif %}
              {% endfor %}

              {% if logoImg %}
                <div class="mb-8">
                  <img src="{{ logoImg.src }}" alt="{{ logoImg.alt }}" class="{{ options.images.globalStyle }} {{ options.images.variants[logoImg.size] }}">
                </div>
              {% endif %}
            {% endif %}

            {# Subtitle sous le logo si nécessaire #}
            {% if variant.heading and options.headings %}
              {% set subtitle = null %}
              {% for heading in options.headings.headings %}
                {% if heading.name == variant.heading %}
                  {% set subtitle = heading %}
                {% endif %}
              {% endfor %}

              {% if subtitle %}
                <{{ "h" + subtitle.level }} class="{{ options.headings.variants[subtitle.style] }}">
                  {{ subtitle.text }}
                </{{ "h" + subtitle.level }}>
              {% endif %}
            {% endif %}
          </div>
        </div>
      </section>

    {# Spécifique à bateaux hero #}
    {% elseif variant.name == "bateaux_hero" %}
      <section class="{{ globalStyle }} {{ variantStyle }} {{ options.class | default('') }} relative overflow-visible">
        {# Vague gauche avec transparence conditionnelle #}
        <div class="absolute left-0 top-1/2 transform -translate-y-1/2 hidden md:block z-20 pointer-events-none">
          {% if variant["image-left"] and options.images %}
            {% set leftWave = null %}
            {% for image in options.images.images %}
              {% if image.name == variant["image-left"] %}
                {% set leftWave = image %}
              {% endif %}
            {% endfor %}

            {% if leftWave %}
              {# Utiliser la variante de taille définie dans images.json #}
              {% set imageVariantLeft = options.images.variants[leftWave.size] | default('w-auto h-auto') %}
              <img src="{{ leftWave.src }}" alt="{{ leftWave.alt }}" class="{{ options.images.globalStyle }} {{ imageVariantLeft }} max-w-none wave-image">
            {% endif %}
          {% endif %}
        </div>

        {# Vague droite avec transparence conditionnelle #}
        <div class="absolute right-0 top-1/2 transform -translate-y-1/2 hidden md:block z-20 pointer-events-none">
          {% if variant["image-right"] and options.images %}
            {% set rightWave = null %}
            {% for image in options.images.images %}
              {% if image.name == variant["image-right"] %}
                {% set rightWave = image %}
              {% endif %}
            {% endfor %}

            {% if rightWave %}
              {# Utiliser la variante de taille définie dans images.json #}
              {% set imageVariantRight = options.images.variants[rightWave.size] | default('w-auto h-auto') %}
              <img src="{{ rightWave.src }}" alt="{{ rightWave.alt }}" class="{{ options.images.globalStyle }} {{ imageVariantRight }} max-w-none wave-image">
            {% endif %}
          {% endif %}
        </div>
        
        {# Bande supérieure en beige pour le super heading #}
        <div class="bg-[theme(--ma-nautic-beige)] py-6 relative z-10">
          <div class="{{ containerStyle }}">
            {# SuperHeading #}
            {% if variant.superHeading and options.headings %}
              {% set superHeading = null %}
              {% for heading in options.headings.headings %}
                {% if heading.name == variant.superHeading %}
                  {% set superHeading = heading %}
                {% endif %}
              {% endfor %}

              {% if superHeading %}
                <{{ "h" + superHeading.level }} class="text-center {{ options.headings.globalStyle }} {{ options.headings.variants[superHeading.style] }}">
                  {{ superHeading.text }}
                </{{ "h" + superHeading.level }}>
              {% endif %}
            {% endif %}
          </div>
        </div>

        {# Fond blanc pour le contenu principal #}
        <div class="bg-white py-12 relative z-10">
          <div class="{{ containerStyle }} relative z-10">
            <div class="flex flex-col items-center">
              {# Main Heading #}
              {% if variant.heading and options.headings %}
                {% set mainHeading = null %}
                {% for heading in options.headings.headings %}
                  {% if heading.name == variant.heading %}
                    {% set mainHeading = heading %}
                  {% endif %}
                {% endfor %}

                {% if mainHeading %}
                  <{{ "h" + mainHeading.level }} class="text-center mb-6 {{ options.headings.globalStyle }} {{ options.headings.variants[mainHeading.style] }}">
                    {{ mainHeading.text }}
                  </{{ "h" + mainHeading.level }}>
                {% endif %}
              {% endif %}

              {# Icon #}
              {% if variant.icon and options.icons %}
                {% set iconData = null %}
                {% for icon in options.icons.icons %}
                  {% if icon.name == variant.icon %}
                    {% set iconData = icon %}
                  {% endif %}
                {% endfor %}

                {% if iconData %}
                  <div class="mb-6">
                    <img src="{{ iconData.path }}" alt="{{ iconData.alt }}" class="w-12 h-12 text-[theme(--ma-nautic-teal)]">
                  </div>
                {% endif %}
              {% endif %}

              {# Description #}
              {% if variant.description %}
                <div class="text-center max-w-3xl mx-auto mb-8">
                  {{ variant.description | safe }}
                </div>
              {% endif %}

              {# ScrollArrow Button #}
              {% if variant.scrollArrowButton and options.buttons %}
                {% set arrowData = null %}
                {% for button in options.buttons.buttons %}
                  {% if button.name == variant.scrollArrowButton %}
                    {% set arrowData = button %}
                  {% endif %}
                {% endfor %}

                {% if arrowData and arrowData.icon and options.icons %}
                  {% set iconImage = null %}
                  {% for icon in options.icons.icons %}
                    {% if icon.name == arrowData.icon %}
                      {% set iconImage = icon %}
                    {% endif %}
                  {% endfor %}

                  {% if iconImage %}
                    <div class="mt-8">
                      <a href="#boat-list" class="inline-block">
                        <img src="{{ iconImage.path }}" alt="{{ iconImage.alt }}" class="w-10 h-10 mx-auto">
                      </a>
                    </div>
                  {% endif %}
                {% endif %}
              {% endif %}
            </div>
          </div>
        </div>
      </section>

      {# Section Hero standard pour les autres variantes #}
    {% else %}
      <section class="{{ globalStyle }} {{ variantStyle }} {{ options.class | default('') }}">
        <div class="{{ containerStyle }}">
          <div class="{{ contentLayoutStyle.mobile }} {{ contentLayoutStyle.desktop }}">
            {# Text Content Column #}
            <div class="{{ textContainerStyle }}">
              {# SuperHeading #}
              {% if variant.superHeading and options.headings %}
                {% set superHeading = null %}
                {% for heading in options.headings.headings %}
                  {% if heading.name == variant.superHeading %}
                    {% set superHeading = heading %}
                  {% endif %}
                {% endfor %}

                {% if superHeading %}
                  <{{ "h" + superHeading.level }} class="{{ options.headings.globalStyle }} {{ options.headings.sizeStyles["h" + superHeading.level] }} {{ options.headings.variants[superHeading.style] }}">
                    {{ superHeading.text }}
                  </{{ "h" + superHeading.level }}>
                {% endif %}
              {% endif %}

              {# Main Heading #}
              {% if variant.heading and options.headings %}
                {% set mainHeading = null %}
                {% for heading in options.headings.headings %}
                  {% if heading.name == variant.heading %}
                    {% set mainHeading = heading %}
                  {% endif %}
                {% endfor %}

                {% if mainHeading %}
                  <{{ "h" + mainHeading.level }} class="{{ options.headings.globalStyle }} {{ options.headings.sizeStyles["h" + mainHeading.level] }} {{ options.headings.variants[mainHeading.style] }}">
                    {{ mainHeading.text }}
                  </{{ "h" + mainHeading.level }}>
                {% else %}
                  <h2 class="{{ options.headings.globalStyle }} {{ options.headings.sizeStyles.h2 }} {{ options.headings.variants.default }}">
                    {{ variant.heading }}
                  </h2>
                {% endif %}
              {% endif %}

              {# Description #}
              {% if variant.description %}
                <p class="{{ variant.descriptionStyle }}">
                  {{ variant.description }}
                </p>
              {% endif %}

              {# Buttons Container #}
              <div class="{{ buttonsContainerStyle }}">
                {# Import button rendering macro #}
                {% from "03-atoms/button.njk" import renderButton %}

                {# Primary Button #}
                {% if variant.primaryButton %}
                  {{ renderButton({ 
                      name: variant.primaryButton,
                      datas: options.buttons
                  }) }}
                {% endif %}

                {# Secondary Button #}
                {% if variant.secondaryButton %}
                  {{ renderButton({ 
                      name: variant.secondaryButton,
                      datas: options.buttons
                  }) }}
                {% endif %}
              </div>
            </div>

            {# Image Column #}
            <div class="{{ imageContainerStyle }}">
              {% if variant.image and options.images %}
                {% set heroImage = null %}
                {% for image in options.images.images %}
                  {% if image.name == variant.image %}
                    {% set heroImage = image %}
                  {% endif %}
                {% endfor %}

                {% if heroImage %}
                  {% set imageVariant = options.images.variants[heroImage.size] %}
                  <img src="{{ heroImage.src }}" alt="{{ heroImage.alt }}" class="{{ options.images.globalStyle }} {{ imageVariant }}">
                {% endif %}
              {% endif %}
            </div>
          </div>
        </div>
      </section>
    {% endif %}
  {% else %}
    <span class="text-red-500">Section Hero data not found</span>
  {% endif %}
{% endmacro %}

{#
============================
Summon HAT Components Wisely
============================

1. Import the macro at the top of your page
{% from "01-organisms/section-hero.njk" import renderSectionHero %}

2. Call the section-hero component with a specific name
{{ renderSectionHero({ 
    name: "bateaux_hero",
    datas: organisms["section-heros"],
    headings: atoms.headings,
    buttons: atoms.buttons,
    images: atoms.images,
    icons: atoms.icons
}) }}

3. Using custom styles
{{ renderSectionHero({ 
    name: "product_hero",
    datas: organisms["section-heros"],
    headings: atoms.headings,
    buttons: atoms.buttons,
    images: atoms.images,
    icons: atoms.icons,
    class: "my-custom-hero-class"
}) }}

4. Using MA-Nautic Hero with Logo
{{ renderSectionHero({ 
    name: "ma_nautic_hero",
    datas: organisms["section-heros"],
    headings: atoms.headings,
    images: atoms.images
}) }}

5. Using Bateaux Hero with waves and special structure
{{ renderSectionHero({ 
    name: "bateaux_hero",
    datas: organisms["section-heros"],
    headings: atoms.headings,
    images: atoms.images,
    icons: atoms.icons,
    buttons: atoms.buttons
}) }}

Every journey begins with a hero section! 🏰🛡️
#}