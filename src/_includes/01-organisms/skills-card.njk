{# 
=========================
    SKILLS-CARD ORGANISM
    v1.2 - Charlotte Desktop + Tablet Logic + Mystery Chest       
=========================
#}

{# Import molecules and atoms #}
{% from "02-molecules/caption.njk" import renderCaption %}
{% from "03-atoms/typography.njk" import renderTypography %}

{% macro renderSkillsCard(option) %}
  {# Check if datas is provided #}
  {% if not option.datas %}
    <span class="text-red-500">Error: No skills-card configuration provided</span>
  {% else %}
    {# Retrieve skills-card configuration #}
    {% set skillsCardConfig = option.datas %}
    {% set skillsCardName = option.name %}
    
    {# Find the specific skills-card by name #}
    {% set skillsCardData = null %}
    {% for skillsCard in skillsCardConfig %}
      {% if skillsCard.name == skillsCardName %}
        {% set skillsCardData = skillsCard %}
      {% endif %}
    {% endfor %}

    {# Fallback if skills-card not found #}
    {% if not skillsCardData %}
      <span class="text-red-500">Skills-card not found: {{ skillsCardName }}</span>
    {% else %}
      {# Calculate mystery chests needed for DESKTOP #}
      {% set totalSlots = 4 if skillsCardData.grid_layout == "2x2" else 6 %}
      {% set existingItems = skillsCardData.captions.length %}
      {% set missingSlots = totalSlots - existingItems %}
      
      {# Calculate mystery chests needed for TABLET LANDSCAPE #}
      {# En tablette: coffres uniquement dans languages_card #}
      {% set isLanguagesCard = (skillsCardData.name == "languages_card") %}
      {% set tabletteMissingSlots = missingSlots if isLanguagesCard else 0 %}
      
      {# Skills Card Container #}
      <div class="skills-card skills-card--{{ skillsCardData.theme }}" data-skills="{{ skillsCardData.name }}">
        
        {# Desktop version: Individual card #}
        <div class="skills-card-desktop">
          <div class="skills-card-content">
            
            {# Card title #}
            <div class="skills-card-title">
              {{ renderTypography({ 
                name: skillsCardData.title,
                datas: option.typography_datas
              }) }}
            </div>
            
            {# Card captions grid #}
            <div class="skills-card-grid skills-card-grid--{{ skillsCardData.grid_layout }}">
              
              {# Render existing captions #}
              {% for captionName in skillsCardData.captions %}
                <div class="skills-card-item">
                  {{ renderCaption({ 
                    name: captionName,
                    datas: option.caption_datas,
                    iconDatas: option.icon_datas,
                    tooltipDatas: option.tooltip_datas
                  }) }}
                </div>
              {% endfor %}
              
              {# Add mystery chests for empty slots #}
              {% for i in range(missingSlots) %}
                <div class="skills-card-item">
                  {{ renderCaption({ 
                    name: "skills_treasure",
                    datas: option.caption_datas,
                    iconDatas: option.icon_datas,
                    tooltipDatas: option.tooltip_datas
                  }) }}
                </div>
              {% endfor %}
              
            </div>
          </div>
        </div>

        {# Tablet Landscape version: Compact card #}
        <div class="skills-card-tablet-landscape">
          <div class="skills-card-content">
            
            {# Card title #}
            <div class="skills-card-title">
              {{ renderTypography({ 
                name: skillsCardData.title,
                datas: option.typography_datas
              }) }}
            </div>
            
            {# Card captions grid #}
            <div class="skills-card-grid skills-card-grid--{{ skillsCardData.grid_layout }}">
              
              {# Render existing captions #}
              {% for captionName in skillsCardData.captions %}
                <div class="skills-card-item">
                  {{ renderCaption({ 
                    name: captionName,
                    datas: option.caption_datas,
                    iconDatas: option.icon_datas,
                    tooltipDatas: option.tooltip_datas
                  }) }}
                </div>
              {% endfor %}
              
              {# Add mystery chests UNIQUEMENT pour languages_card en tablette #}
              {% for i in range(tabletteMissingSlots) %}
                <div class="skills-card-item">
                  {{ renderCaption({ 
                    name: "skills_treasure",
                    datas: option.caption_datas,
                    iconDatas: option.icon_datas,
                    tooltipDatas: option.tooltip_datas
                  }) }}
                </div>
              {% endfor %}
              
            </div>
          </div>
        </div>
      </div>
    {% endif %}
  {% endif %}
{% endmacro %}

{# 
============================
Summon HAT Components Wisely
============================

1. Import the macro at the top of your page
{% from "01-organisms/skills-card.njk" import renderSkillsCard %}

2. Call each skills-card individually 

DESKTOP:
- interests_card: 6 items ‚Üí 0 coffre ‚úÖ
- soft_skills_card: 3 items ‚Üí 1 coffre ‚úÖ  
- hard_skills_card: 3 items ‚Üí 1 coffre ‚úÖ
- languages_card: 5 items ‚Üí 1 coffre ‚úÖ

TABLET LANDSCAPE:
- interests_card: 6 items ‚Üí 0 coffre ‚úÖ
- soft_skills_card: 3 items ‚Üí 0 coffre ‚úÖ  
- hard_skills_card: 3 items ‚Üí 0 coffre ‚úÖ
- languages_card: 5 items ‚Üí 1 coffre ‚úÖ

{{ renderSkillsCard({ 
    name: "interests_card",
    datas: organisms["skills-card"]["skills-cards"],
    typography_datas: atoms.typography.texts,
    caption_datas: molecules.caption.captions,
    icon_datas: atoms.icon.icons,
    tooltip_datas: atoms.tooltip.tooltips
}) }}

May your responsive grids be forever aligned. üßô‚Äç‚ôÇÔ∏è‚ú®
#}